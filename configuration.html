<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FootNet — Configuration</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="FootNet configuration options">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="https://github.com/nd349/FootNet.ico" type="image/x-icon">
  <link rel="stylesheet" href="./FootNet_files/prism.css">
  <link rel="stylesheet" href="./FootNet_files/styles.css">

  <style>
    body { margin: 0; font-family: Arial, sans-serif; color: #333; }
    main.layout { display: flex; flex-direction: row; }
    .sidebar { width: 200px; background: #f9f9f9; border-right: 1px solid #ddd; padding: 16px; position: sticky; top: 0; }
    .app-name { margin: 0 0 14px 0; font-size: 18px; }
    .app-name-link { text-decoration: none; color: #222; }
    .sidebar-nav ul { list-style: none; padding-left: 10px; }
    .sidebar-nav li { margin: 5px 0; }
    .sidebar-nav a { text-decoration: none; color: #0066cc; }
    .sidebar-footer { margin-top: 20px; font-size: 12px; color: #555; }
  .content { flex: 1; padding: 30px; max-width: 1500px; }
    .markdown-section h2 { border-bottom: 1px solid #ddd; padding-bottom: 5px; }
    /* Code block styling for better visibility */
    pre, code { font-family: Menlo, Monaco, 'Courier New', monospace; }
    pre { background: #f6f8fa; color: #0b0b0b; padding: 12px; border-radius: 6px; border: 1px solid #e1e4e8; overflow: auto; }
    pre code { background: transparent; color: inherit; }
  </style>
</head>
<body>
  <!-- GitHub corner -->
  <a href="https://github.com/nd349/FootNet" target="_blank" class="github-corner" aria-label="View source on Github">
    <svg viewBox="0 0 250 250" aria-hidden="true" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" width="80" height="80">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
  </a>

  <main class="layout">
    <aside class="sidebar">
  <h1 class="app-name"><a class="app-name-link" href="index.html"><span class="color-primary text-bold">FootNet</span> Project</a></h1>
      <div class="sidebar-nav">
        <ul>
          <li><p>Getting started</p>
            <ul>
              <li><a href="index.html" title="Introduction">Introduction</a></li>
              <li><a href="quick-start.html" title="Quick start">Quick start</a></li>
            </ul>
          </li>
          <li><p>Documentation</p>
            <ul>
              <li><a href="configuration.html" title="Configuration">Configuration</a></li>
              <li><a href="meteorological-data.html" title="Meteorological data">Meteorological data</a></li>
              <li><a href="output-files.html" title="Output files">Output files</a></li>
            </ul>
          </li>
          <li><p>FootNet model</p>
            <ul>
              <li><a href="training.html" title="Training FootNet">Training FootNet</a></li>
              <li><a href="model-weights.html" title="Model weights">Model weights</a></li>
            </ul>
          </li>
        </ul>
        <div class="sidebar-footer text-bold"><small>© 2025 FootNet Developers</small></div>
      </div>
    </aside>

    <section class="content">
      <article class="markdown-section">
        <h2>Configuration</h2>
        <p>Running FootNet requires spatial domain, list of receptors, and meteorological data inputs.</p>

        <h3>Spatial Domain</h3>
        <p>The spatial domain requires 1D arrays of latitudes and longitudes with units of degrees 
          (convert longitudes from 0<sup>o</sup> - 360<sup>o</sup> to -180<sup>o</sup> - 180<sup>o</sup> scale). We used 
          spatial_resolution=1/120 for input meteorology and footprint resolutions.</p>
        <pre><code class="language-python">lats = np.arange(lat<sub>0</sub>, lat<sub>n</sub>, spatial_resolution)
lons = np.arange(lon<sub>0</sub>, lon<sub>n</sub>, spatial_resolution)
</code></pre>

        <h3>HRRR lite files</h3>
        <p>Python doesn't support efficient data loading of the original HRRR files, it takes very large time to load those files. 
          We recommend using HRRR lite files which are preprocessed to be more efficient for loading. The HRRR lite files are netcdf files 
          only containing met fields required by the FootNet for efficient data loading. The data loading from lite files is 8-10 time faster than the HRRR original data.</p>
        <p>Please use this <a href="https://github.com/nd349/FootNet/blob/main/footnet/get_HRRR_met_lite_files.py" target="_blank" rel="noopener">script</a> to convert original HRRR files to HRRR lite files.
        

        <p>However, if user wants to use original HRRR files, they can make the following changes in the 
          get_met_column_data_lite of Column Meteorology or get_met_surface_data_lite functions of SurfaceMeteorology objects:</p>
          <pre><code class="language-python">Replace: fh = nc.Dataset(h3rfile)
With: fh = xr.open_dataset(h3rfile, engine="pseudonetcdf") # This may require you to install pseudonetcdf package through pip install pseudonetcdf.
</code></pre>
        <p>Note: You may also have to make a few more changes based on the data structure of your meteorology. For example, 
          updating get_hrrr_file() function to correctly access meteorology files. We used different directories for different 
          years to store meteorology files. You may have to change this function if your data files are present in a single 
          directory instead.</p>

        <p>The HRRR data contains x-y coordinates for each grid cell. We use 
          <a href="https://github.com/nd349/FootNet/blob/main/data/HRRR_lon_lat.npz" target="_blank" rel="noopener">
            HRRR_lon_lat.npz</a> to map these coordinates to lat-lon space.</p>

        <h3>Defining Receptors</h3>
        <p>Defining a receptor requires timestamp of measurement (datetime object), and geographical coordinates (latitude and longitude).</p>
        <pre><code class="language-python">receptor = [datetime.datetime(yyyy, mm, dd, hh), receptor_lon, receptor_lat]
</code></pre>
        <p>FootNet requires a list of receptors compute footprints, as such multiple receptors can be provided as a list of lists</p>
        <pre><code class="language-python">receptor1 = [datetime.datetime(yyyy, mm, dd, hh)1, receptor_lon1, receptor_lat1],
receptor2 = [datetime.datetime(yyyy, mm, dd, hh)2, receptor_lon2, receptor_lat2],
receptor3 = [datetime.datetime(yyyy, mm, dd, hh)3, receptor_lon3, receptor_lat3],

receptors_list = [receptor1, receptor2, receptor3]
</code></pre>

        <h3>FootNet post-processing</h3>
        <p>The post-processing of FootNet outputs is required since FootNet training was not done in the footprint space. The post-processing converts the FootNet output to footprint space.</p>
        <pre>
epsilon = 1e-3 # Surface FootNet
epsilon = 1e-4 # Column FootNet
</pre>
      </article>
    </section>
  </main>

  <script src="./FootNet_files/docsify.min.js"></script>
  <script src="./FootNet_files/prism-bash.min.js"></script>
  <script src="./FootNet_files/prism-python.min.js"></script>
</body>
</html>
